<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Document</title>
        <script src="https://apis.google.com/js/api.js"></script>
    </head>
    <body>
        <button onclick="getSheetData()">
            Получить данные из Google Sheets
        </button>

        <button onclick="updateSheetData()">добавить</button>
        <script>
            const spreadsheetID =
                "1fT1vde_yz9iGiCHg830dqXXuUO9385tEc4AslthWaJo";
            const api_Key = "AIzaSyDfjahtPTNucFpXw7LcuMFShc7C-N6K3ec";
            const clientID = "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";

            // Функция для инициализации Google Sheets API с аутентификацией OAuth2
            function initGoogleSheetsAPI() {
                gapi.client
                    .init({
                        apiKey: api_Key,
                        clientId: clientID,
                        discoveryDocs: [
                            "https://sheets.googleapis.com/$discovery/rest?version=v4",
                        ],
                        scope: "https://www.googleapis.com/auth/spreadsheets",
                    })
                    .then(
                        function () {
                            console.log("Google Sheets API initialized");
                        },
                        function (error) {
                            console.error(
                                "Error initializing Google Sheets API:",
                                error
                            );
                        }
                    );
            }

            // Инициализация Google Sheets API после загрузки страницы
            gapi.load("client", initGoogleSheetsAPI);
        </script>

        <script>
            // const spreadsheetID =
            //     "1fT1vde_yz9iGiCHg830dqXXuUO9385tEc4AslthWaJo";
            // const api_Key = "AIzaSyDfjahtPTNucFpXw7LcuMFShc7C-N6K3ec";
            // const clientID = "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";

            // // Функция для инициализации Google Sheets API
            // function initGoogleSheetsAPI() {
            //     gapi.client
            //         .init({
            //             apiKey: api_Key,
            //             discoveryDocs: [
            //                 "https://sheets.googleapis.com/$discovery/rest?version=v4",
            //             ],
            //         })
            //         .then(
            //             function () {
            //                 console.log("Google Sheets API initialized");
            //             },
            //             function (error) {
            //                 console.error(
            //                     "Error initializing Google Sheets API:",
            //                     error
            //                 );
            //             }
            //         );
            // }

            // // Функция для чтения данных из Google Sheets
            // function getSheetData() {
            //     gapi.client.sheets.spreadsheets.values
            //         .get({
            //             spreadsheetId: spreadsheetID,
            //             range: "Sheet1!A1:A5", // Замените на нужный диапазон ячеек для чтения
            //         })
            //         .then(
            //             function (response) {
            //                 const values = response.result.values;
            //                 console.log("Данные из Google Sheets:", values);
            //             },
            //             function (error) {
            //                 console.error(
            //                     "Error reading data from Google Sheets:",
            //                     error.result.error.message
            //                 );
            //             }
            //         );
            // }
            // // Инициализация Google Sheets API после загрузки страницы
            // gapi.load("client", initGoogleSheetsAPI);
        </script>
    </body>
</html>
